<h2>Memory Game</h2>
<style>
.memory_box{
  background-color:orange;
  width: 200px;
  height: 200px;
  text-align: center;
  line-height: 200px;
  font-size: 50px;
}
.matched{
  background-color: lightgreen;
  color: white;
  font-weight: bold
}
</style>

<table>
  <tr>
    <td>
      <div class = "memory_box" id = "box_0"></div>
    </td>
    <td>
      <div class = "memory_box" id = "box_1"></div>
    </td>
    <td>
      <div class = "memory_box" id = "box_2"></div>
    </td>
    <td>
      <div class = "memory_box" id = "box_3"></div>
    </td>
    <td>
      <div class = "memory_box" id = "box_4"></div>
    </td>
  </tr>
  <tr>
    <td>
      <div class = "memory_box" id = "box_5"></div>
    </td>
    <td>
      <div class = "memory_box" id = "box_6"></div>
    </td>
    <td>
      <div class = "memory_box" id = "box_7"></div>
    </td>
    <td>
      <div class = "memory_box" id = "box_8"></div>
    </td>
    <td>
      <div class = "memory_box" id = "box_9"></div>
    </td>
  </tr>
</table>

<script src="jquery-3.7.1.min.js"></script>

<script>
card_obj = {
  card_letters: [
    "a", //box 0
    "b", //box 1
    "c", //box 2
    "d", //box 3
    "e", //box 4
    "a", //box 5
    "b", //box 6
    "c", //box 7
    "d", //box 8
    "e"  //box 9
  ],
  visible_letters: [],
  selected_boxes: [],
  matched_boxes: []
};

/*
  Javascript implementation of the Fisher-Yates shuffle
  Will randomise order of card_letters for each user
*/
function shuffle(array) {
  let currentIndex = array.length;

  // While there remain elements to shuffle...
  while (currentIndex != 0) {

    // Pick a remaining element...
    let randomIndex = Math.floor(Math.random() * currentIndex);
    currentIndex--;

    // And swap it with the current element.
    [array[currentIndex], array[randomIndex]] = [
      array[randomIndex], array[currentIndex]];
  }
}

let arr = card_obj["card_letters"]
shuffle(arr);
console.log(arr);

</script>

<script>
$(".memory_box").on("click", function(){
  var this_index = this.id.replace("box_", "");
  var this_letter = card_obj.card_letters[this_index];
  $(this).html(this_letter)

  // Prevent clicking already matched matched_boxes
  if($(this).hasClass("matched")) return;

  // Add to selection arrays
  card_obj["selected_boxes"].push(this.id);
  card_obj["visible_letters"].push(this_letter);

  var cards_visible = card_obj["selected_boxes"].length;

  if(cards_visible == 2){
    var first_letter = card_obj["visible_letters"][0];
    var second_letter = card_obj["visible_letters"][1];
    var first_box = card_obj["selected_boxes"][0];
    var second_box = card_obj["selected_boxes"][1];

    if(first_letter == second_letter){
      // Mark them as matched
      $("#" + first_box).addClass("matched");
      $("#" + second_box).addClass("matched");

      // Track matched boxes
      card_obj["matched_boxes"].push(first_box, second_box);

      //Reset for next turn
      card_obj["selected_boxes"] = [];
      card_obj["visible_letters"] = [];

      // Check win condition
      if(card_obj["matched_boxes"].length === card_obj.card_letters.length){
        setTimeout(function(){
          alert("You win!");
        }, 500);
      }
    } else {
      // If not a match, hide letters after delay
      setTimeout(function(){
        $("#" + first_box).html("");
        $("#" + second_box).html("");
        card_obj["selected_boxes"] = [];
        card_obj["visible_letters"] = [];
      }, 1000);
    }
  }
  });
</script>
